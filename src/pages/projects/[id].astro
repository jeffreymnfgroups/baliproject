---
// src/pages/projects/[id].astro - Bali Beach Sports & Recreation Facility
import type { GetStaticPaths, GetStaticPathsResult } from "astro";
import ProjectLayout from '../../layouts/ProjectLayout.astro';
import type { ProjectData } from '../../types/project';
import { projects } from '../../data/projects.js';
import type { ImageMetadata } from 'astro';

// Define the project info type based on your projects data structure
interface ProjectInfo {
  id: number;
  number: string;
  name: string;
  location: string;
  image: ImageMetadata;
  headline?: string;
  subheadline?: string;
  description?: string;
}

// Project-specific content data with proper typing
interface ProjectContent {
  description: string;
  aboutProject: string;
  typology: string[];
  status: string;
  year: number;
  location: string;
  area: string;
  features?: string[];
  sustainability?: string[];
}

type ProjectContentMap = {
  [key: string]: ProjectContent;
};

const projectContent: ProjectContentMap = {
  'hero-aerial-view': {
    description: 'High-resolution top-down layout visual of the entire facility showcasing the integrated arena for surf, play, recovery, and community.',
    aboutProject: `Welcome to the Future of Global Beach Sport & Wellness Tourism. This aerial perspective showcases Bali's integrated arena for surf, play, recovery, and community.

The facility spans over 50 hectares of prime beachfront land, designed as a comprehensive sports and wellness destination that serves both local communities and international visitors. The master plan integrates cutting-edge sports technology with environmental responsibility, creating a model for sustainable tourism development.

Key Features:
- 15 distinct sports and recreation zones
- Integrated sustainability systems
- Community-focused design
- International partnership facilities
- 24/7 operational capability
- Over 400 local jobs created

This is not just a resort—it's a revolution in how we approach sports tourism, community development, and environmental stewardship.`,
    typology: ['Sports Facility', 'Wellness Tourism'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali, Indonesia',
    area: '50+ Hectares',
    features: ['Aerial Layout Design', 'Master Planning', 'Environmental Integration'],
    sustainability: ['Solar Energy Systems', 'Water Recycling', 'Local Materials']
  },
  
  'waterpark': {
    description: 'Water slides, lazy river, kids zones - Bali\'s most iconic water attraction for fun and adventure for all ages.',
    aboutProject: `Bali's most iconic water attraction designed for fun and adventure for all ages. The waterpark features state-of-the-art water attractions that combine thrill with family-friendly experiences.

The facility includes multiple themed zones catering to different age groups and activity levels, from gentle toddler areas to adrenaline-pumping slides for thrill-seekers.

Key Features:
- Multiple themed water zones
- Advanced water filtration systems
- Safety-certified attractions
- Family-friendly design
- Educational water features
- Sustainable water management`,
    typology: ['Water Attractions', 'Family Entertainment'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali Beach Sports Facility',
    area: '15,000 m2',
    features: ['Water Slides', 'Lazy River', 'Kids Zones', 'Wave Pool'],
    sustainability: ['Water Recycling', 'Energy-Efficient Pumps', 'Natural Filtration']
  },
  
  'dual-surf-machines': {
    description: 'Surfers in action — one section for beginners, one for advanced surfers. Ride World-Class Waves in Paradise with two wave systems for every level of surfing.',
    aboutProject: `Ride World-Class Waves in Paradise with our dual surf machine system powered by URBNSURF technology. This facility offers two distinct wave systems catering to every level of surfing experience.

The advanced wave system provides professional-grade waves for experienced surfers, while the recreational system offers gentle, consistent waves perfect for beginners and intermediate surfers.

Key Features:
- URBNSURF wave technology
- Dual wave systems
- Professional coaching facilities
- Equipment rental and sales
- Surf school programs
- Competition-ready facilities`,
    typology: ['Surf Technology', 'Sports Training'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali Beach Sports Facility',
    area: '8,000 m2',
    features: ['Advanced Wave System', 'Recreational Waves', 'Surf School', 'Equipment Center'],
    sustainability: ['Ocean Water Use', 'Energy-Efficient Systems', 'Zero Chemical Treatment']
  },
  
  'beach-sports-arena': {
    description: 'Mixed beach volleyball, tennis, cricket, soccer, and badminton in action. Bali\'s first multi-sport beach arena, hosting local and international events.',
    aboutProject: `Where Sand Meets Skill - Bali's first multi-sport beach arena designed to host local and international events. This versatile facility accommodates multiple sports disciplines with professional-grade equipment and facilities.

The arena is designed to meet international competition standards while remaining accessible to local communities and recreational users.

Key Features:
- Multi-sport configuration
- Professional-grade equipment
- International competition standards
- Flexible court layouts
- Spectator seating
- Event hosting capabilities`,
    typology: ['Multi-Sport Arena', 'Competition Venue'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali Beach Sports Facility',
    area: '12,000 m2',
    features: ['Beach Volleyball', 'Tennis Courts', 'Cricket Ground', 'Soccer Field', 'Badminton Courts'],
    sustainability: ['Natural Sand Surfaces', 'Solar Lighting', 'Rainwater Collection']
  },
  
  'racquet-sports-complex': {
    description: 'Undercover and open-air courts for tennis, pickleball, and padel. Elite Courts for Every Passion designed for athletes, families, and local development.',
    aboutProject: `Elite Courts for Every Passion - Designed for athletes, families, and local development. The racquet sports complex features both undercover and open-air courts for tennis, pickleball, and padel.

The facility combines professional training environments with community accessibility, supporting both competitive athletes and recreational players.

Key Features:
- Professional-grade courts
- Undercover and outdoor options
- Multi-sport flexibility
- Coaching facilities
- Equipment rental
- Tournament hosting`,
    typology: ['Racquet Sports', 'Training Facility'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali Beach Sports Facility',
    area: '6,000 m2',
    features: ['Tennis Courts', 'Pickleball Courts', 'Padel Courts', 'Training Center'],
    sustainability: ['Energy-Efficient Lighting', 'Natural Ventilation', 'Sustainable Materials']
  },
  
  'extreme-sports-zone': {
    description: 'Skate park, BMX ramps, ninja warrior course. Bali\'s New Hub for Youth and Action Sports designed for energy, performance, and adrenaline.',
    aboutProject: `Bali's New Hub for Youth and Action Sports - Designed for energy, performance, and adrenaline. The extreme sports zone features world-class facilities for skateboarding, BMX, and ninja warrior training.

This zone is designed to attract young athletes and action sports enthusiasts while providing safe, professional-grade facilities for skill development and competition.

Key Features:
- Professional skate park
- BMX ramps and tracks
- Ninja warrior course
- Safety equipment
- Coaching programs
- Competition venues`,
    typology: ['Action Sports', 'Youth Development'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali Beach Sports Facility',
    area: '10,000 m2',
    features: ['Skate Park', 'BMX Ramps', 'Ninja Warrior Course', 'Safety Equipment'],
    sustainability: ['Recycled Materials', 'Energy-Efficient Lighting', 'Natural Shading']
  },
  
  'digital-sports': {
    description: 'eSports arena setup and interactive mixed reality workout areas. Where Gaming and Fitness Collide - Innovation meets movement in Bali\'s first digital sports hub.',
    aboutProject: `Where Gaming and Fitness Collide - Innovation meets movement in Bali's first digital sports hub. The digital sports zone combines cutting-edge eSports facilities with interactive mixed reality fitness experiences.

This forward-thinking facility bridges the gap between traditional sports and digital innovation, creating unique experiences that appeal to both gamers and fitness enthusiasts.

Key Features:
- Professional eSports arena
- Mixed reality fitness zones
- Gaming tournaments
- Interactive training
- Technology integration
- Innovation showcase`,
    typology: ['Digital Sports', 'eSports', 'Mixed Reality'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali Beach Sports Facility',
    area: '4,000 m2',
    features: ['eSports Arena', 'Mixed Reality Fitness', 'Gaming Tournaments', 'Interactive Training'],
    sustainability: ['Energy-Efficient Equipment', 'Digital Innovation', 'Sustainable Technology']
  },
  
  'wellness-and-fitness-zones': {
    description: 'Gym, yoga decks, nature-integrated wellness pavilions. Mind. Body. Balance. For athletes, tourists, and recovery-focused guests.',
    aboutProject: `Mind. Body. Balance. - For athletes, tourists, and recovery-focused guests. The wellness and fitness zones provide comprehensive facilities for physical training, mental wellness, and holistic health.

The facility integrates traditional wellness practices with modern fitness technology, creating a unique environment that supports both athletic performance and personal wellness.

Key Features:
- Modern fitness equipment
- Yoga and meditation spaces
- Nature-integrated design
- Personal training services
- Wellness programs
- Recovery facilities`,
    typology: ['Wellness', 'Fitness', 'Recovery'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali Beach Sports Facility',
    area: '8,000 m2',
    features: ['Gym Equipment', 'Yoga Decks', 'Wellness Pavilions', 'Recovery Areas'],
    sustainability: ['Natural Materials', 'Energy-Efficient Systems', 'Biophilic Design']
  },
  
  'spa-and-recovery-centre': {
    description: 'Massage, saunas, plunge pools, ice baths. Recover. Reset. Recharge. Elite performance facilities for full recovery and wellness.',
    aboutProject: `Recover. Reset. Recharge. - Elite performance facilities for full recovery and wellness. The spa and recovery centre provides professional-grade facilities for athletes and wellness seekers.

The facility combines traditional Balinese healing practices with modern recovery technology, offering comprehensive wellness services in a serene, natural setting.

Key Features:
- Professional massage services
- Traditional and modern saunas
- Plunge pools and ice baths
- Recovery technology
- Wellness consultations
- Holistic treatments`,
    typology: ['Spa', 'Recovery', 'Wellness'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali Beach Sports Facility',
    area: '5,000 m2',
    features: ['Massage Services', 'Saunas', 'Plunge Pools', 'Ice Baths', 'Recovery Technology'],
    sustainability: ['Natural Healing', 'Energy-Efficient Systems', 'Local Therapies']
  },
  
  'food-beverage-and-culinary-experience': {
    description: 'Healthy food kiosks, local cuisine, dining terraces. From Bali\'s Soil to Your Plate - Locally sourced, nutritionally driven food experiences.',
    aboutProject: `From Bali's Soil to Your Plate - Locally sourced, nutritionally driven food experiences. The culinary zone showcases Bali's rich food culture while providing healthy, sustainable dining options.

The facility emphasizes farm-to-table practices, supporting local farmers and promoting sustainable food systems while offering diverse dining experiences for all visitors.

Key Features:
- Local cuisine focus
- Healthy food options
- Sustainable sourcing
- Educational programs
- Culinary workshops
- Community dining`,
    typology: ['Culinary', 'Dining', 'Education'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali Beach Sports Facility',
    area: '6,000 m2',
    features: ['Healthy Food Kiosks', 'Local Cuisine', 'Dining Terraces', 'Culinary Workshops'],
    sustainability: ['Local Sourcing', 'Organic Practices', 'Zero Waste', 'Community Support']
  },
  
  'eco-accommodation-and-lodging': {
    description: 'Treehouse pods, bamboo villas, sports lodges. Stay Inspired - Bespoke sustainable living experiences for every visitor.',
    aboutProject: `Stay Inspired - Bespoke sustainable living experiences for every visitor. The eco-accommodation zone offers unique lodging options that blend comfort with environmental responsibility.

The facility features innovative sustainable architecture using local materials and traditional building techniques, creating authentic Balinese experiences with modern amenities.

Key Features:
- Sustainable architecture
- Local materials
- Traditional techniques
- Modern amenities
- Natural integration
- Community connection`,
    typology: ['Accommodation', 'Eco-Tourism', 'Sustainable Living'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali Beach Sports Facility',
    area: '15,000 m2',
    features: ['Treehouse Pods', 'Bamboo Villas', 'Sports Lodges', 'Eco-Friendly Design'],
    sustainability: ['Local Materials', 'Traditional Techniques', 'Natural Integration', 'Community Support']
  },
  
  'sustainability-and-environmental-responsibility': {
    description: 'Solar panels, water recycling systems, local concrete solutions. Built for a Sustainable Tomorrow - Ocean water use, solar energy, zero-carbon concrete, local materials.',
    aboutProject: `Built for a Sustainable Tomorrow - Ocean water use, solar energy, zero-carbon concrete, local materials. The sustainability zone demonstrates cutting-edge environmental technologies and practices.

This facility serves as a model for sustainable development, showcasing how large-scale sports facilities can operate with minimal environmental impact while supporting local communities.

Key Features:
- Solar energy systems
- Water recycling
- Zero-carbon materials
- Local sourcing
- Environmental education
- Innovation showcase`,
    typology: ['Sustainability', 'Environmental', 'Innovation'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali Beach Sports Facility',
    area: 'System-Wide',
    features: ['Solar Panels', 'Water Recycling', 'Local Concrete', 'Environmental Systems'],
    sustainability: ['Renewable Energy', 'Water Conservation', 'Carbon Reduction', 'Local Materials']
  },
  
  'community-and-job-creation': {
    description: 'Local teams working, training, and participating. Investing in People, Not Just Property - Over 400 jobs created. Local training. Community led.',
    aboutProject: `Investing in People, Not Just Property - Over 400 jobs created. Local training. Community led. The community and job creation zone focuses on developing local talent and creating sustainable employment opportunities.

The facility prioritizes local hiring, training programs, and community involvement, ensuring that the development benefits the surrounding communities while creating long-term economic opportunities.

Key Features:
- Local employment focus
- Training programs
- Community involvement
- Skill development
- Economic opportunities
- Social impact`,
    typology: ['Community Development', 'Job Creation', 'Social Impact'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali Beach Sports Facility',
    area: 'Community-Wide',
    features: ['Local Employment', 'Training Programs', 'Community Involvement', 'Skill Development'],
    sustainability: ['Social Sustainability', 'Economic Development', 'Community Support', 'Local Empowerment']
  },
  
  'partnerships-and-global-recognition': {
    description: 'FIVB, ITF, URBNSURF, Extreme, Global eSports Federations. Powered by the World\'s Most Visionary Brands - Backed by sport, tech, and performance leaders.',
    aboutProject: `Powered by the World's Most Visionary Brands - Backed by sport, tech, and performance leaders. The partnerships zone showcases international collaborations with leading sports organizations and technology companies.

These partnerships ensure world-class facilities, international standards, and access to cutting-edge technology and expertise from global leaders in their respective fields.

Key Features:
- International partnerships
- World-class standards
- Technology integration
- Expert collaboration
- Global recognition
- Innovation leadership`,
    typology: ['Partnerships', 'International', 'Innovation'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali Beach Sports Facility',
    area: 'Facility-Wide',
    features: ['FIVB Partnership', 'ITF Collaboration', 'URBNSURF Technology', 'Extreme Sports', 'eSports Federations'],
    sustainability: ['International Standards', 'Technology Innovation', 'Expert Collaboration', 'Global Recognition']
  },
  
  'final-section-call-to-action': {
    description: 'Sunset wide shot of the facility. This is Not a Resort. It\'s a Revolution. Contact us to learn more, view our site plan, or schedule a walk-through.',
    aboutProject: `This is Not a Resort. It's a Revolution. - Contact us to learn more, view our site plan, or schedule a walk-through.

The Bali Beach Sports & Recreation Facility represents a paradigm shift in sustainable tourism and community development. This world-class facility combines cutting-edge sports technology with environmental responsibility, creating a model for future developments.

Our facility is designed to serve both local communities and international visitors, creating over 400 jobs while preserving Bali's natural beauty through innovative sustainability practices.

Key Features:
- Revolutionary approach to sports tourism
- Sustainable development model
- Community-focused design
- Environmental responsibility
- Economic impact
- Social innovation`,
    typology: ['Revolution', 'Innovation', 'Sustainability'],
    status: 'Under Development',
    year: 2024,
    location: 'Bali, Indonesia',
    area: '50+ Hectares',
    features: ['Revolutionary Design', 'Sustainable Model', 'Community Impact', 'Environmental Stewardship'],
    sustainability: ['Paradigm Shift', 'Innovation Leadership', 'Community Development', 'Environmental Responsibility']
  }
};

// Generate static paths for all projects (excluding project ID 15 which redirects to about page)
export const getStaticPaths: GetStaticPaths = async (): Promise<GetStaticPathsResult> => {
  const paths = projects
    .filter(project => project.id !== 15) // Exclude project ID 15 from static path generation
    .map((project) => {
      const projectId = project.name.toLowerCase().replace(/[\s&]/g, '-').replace(/--+/g, '-');
      
      return {
        params: { 
          id: projectId 
        },
        props: { 
          projectInfo: project,
          projectId: projectId
        }
      };
    });
  
  return paths;
};

// Extract props safely without type assertion
const projectInfo = Astro.props.projectInfo as ProjectInfo;
const projectId = Astro.props.projectId as string;

// Enhanced image loading function
async function loadProjectImages(projectLocation: string, projectId: string): Promise<{
  heroImage: ImageMetadata;
  galleryImages: Array<{
    src: ImageMetadata;
    alt: string;
    width: number;
    height: number;
  }>;
}> {
  // Get all image modules with import.meta.glob
  const imageModules = import.meta.glob<{ default: ImageMetadata }>('../../assets/projects/**/*.{webp,jpg,jpeg,png}', { eager: true });
  
  // Normalize location name for path matching
  const locationPath = projectLocation.toLowerCase();
  
  // Try to find hero image (main-image.webp)
  let heroImage: ImageMetadata = projectInfo.image; // fallback to project list image
  const heroImagePath = `../../assets/projects/${locationPath}/${projectId}/main-image.webp`;
  
  if (imageModules[heroImagePath]) {
    heroImage = imageModules[heroImagePath].default;
  }
  
  // Try to find gallery images (gallery-1.webp, gallery-2.webp, etc.)
  const galleryImages: Array<{
    src: ImageMetadata;
    alt: string;
    width: number;
    height: number;
  }> = [];
  
  // Check for gallery images up to 20
  for (let i = 1; i <= 20; i++) {
    const galleryImagePath = `../../assets/projects/${locationPath}/${projectId}/gallery-${i}.webp`;
    
    if (imageModules[galleryImagePath]) {
      galleryImages.push({
        src: imageModules[galleryImagePath].default,
        alt: `${projectInfo.name} - Gallery Image ${i}`,
        width: 1200,
        height: 800
      });
    }
  }
  
  // If no gallery images found, return empty array (don't create fake duplicates)
  if (galleryImages.length === 0) {
    console.log(`No gallery images found for ${projectInfo.name} - showing single image layout`);
  }
  
  return {
    heroImage,
    galleryImages
  };
}

// Load images for this project
const { heroImage, galleryImages } = await loadProjectImages(projectInfo.location, projectId);

// Get project-specific content with proper type checking
const content: ProjectContent = projectContent[projectId] || {
  description: `A world-class sports and recreation facility offering cutting-edge technology with environmental responsibility.`,
  aboutProject: `${projectInfo.name} represents a paradigm shift in sustainable sports tourism and community development. This revolutionary facility combines cutting-edge sports technology with environmental responsibility, creating a model for future developments.

The facility is designed to serve both local communities and international visitors, creating over 400 jobs while preserving Bali's natural beauty through innovative sustainability practices.

Key Features:
- World-class sports facilities
- Sustainable development practices
- Community-focused design
- Environmental responsibility
- Economic impact
- Social innovation`,
  typology: ['Sports Facility', 'Sustainable Development'],
  status: 'Under Development',
  year: 2024,
  location: `${projectInfo.location}, Bali`,
  area: '50+ Hectares',
  features: ['World-Class Facilities', 'Sustainable Design', 'Community Impact'],
  sustainability: ['Environmental Responsibility', 'Social Innovation', 'Economic Development']
};

const projectData: ProjectData = {
  id: projectId,
  name: projectInfo.headline || projectInfo.name,
  location: projectInfo.location,
  description: content.description,
  heroImage: {
    src: heroImage,
    alt: `${projectInfo.name} - Main View`,
    width: 1920,
    height: 1080
  },
  info: {
    typology: content.typology,
    status: content.status,
    yearOfDesign: content.year,
    location: content.location,
    square: content.area
  },
  aboutProject: content.aboutProject,
  galleryImages: galleryImages
};
---

<ProjectLayout project={projectData} />